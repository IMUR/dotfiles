#!/bin/sh
# ~/.ssh/rc - runs for ALL SSH sessions (non-login too)
# Sets up environment via ~/.ssh/environment (requires PermitUserEnvironment yes)

# Create environment file with correct PATH
cat > ~/.ssh/environment << 'EOF'
PATH=/home/${USER}/.local/bin:/home/${USER}/bin:/home/${USER}/.cargo/bin:/usr/local/bin:/usr/bin:/bin:/usr/games
EOF

# Replace ${USER} with actual username
sed -i "s/\${USER}/$USER/g" ~/.ssh/environment

# Source profile for any additional setup (silent)
[ -f "$HOME/.profile" ] && . "$HOME/.profile" >/dev/null 2>&1 || true