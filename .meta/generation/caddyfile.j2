# GENERATED FILE - DO NOT EDIT MANUALLY
# Generated from: state/domains.yml
# Template: .meta/generation/caddyfile.j2
# Generated at: {{ timestamp }}
#
# To regenerate: ./scripts/generate/regenerate-all.sh

# Global options
{
	email admin@ism.la
}

# Root domain redirects
ism.la {
	redir https://www.ism.la permanent
}

www.ism.la {
	respond "Welcome to ism.la - Co-lab Cluster Gateway" 200
}

{% for domain in domains %}
# {{ domain.service }} - {{ domain.fqdn }}
{{ domain.fqdn }} {
{% if domain.type == 'websocket' %}
	# WebSocket proxy configuration
	reverse_proxy {{ domain.backend }} {
		header_up Upgrade {>Upgrade}
		header_up Connection {>Connection}
	}
{% elif domain.type == 'sse' %}
	# Server-Sent Events (SSE) configuration
	reverse_proxy {{ domain.backend }} {
		flush_interval -1
	}
{% elif domain.type == 'https_backend' %}
	# HTTPS backend with TLS skip verification
	reverse_proxy {{ domain.backend }} {
		transport http {
{% if domain.tls_skip_verify %}
			tls_insecure_skip_verify
{% endif %}
		}
	}
{% else %}
	# Standard reverse proxy
	reverse_proxy {{ domain.backend }}
{% endif %}
}

{% endfor %}
