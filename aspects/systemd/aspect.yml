---
aspect: systemd
domain: All systemd-managed services on cooperator
owner: System

services:
  gateway:
    - caddy
    - pihole-FTL
    - nfs-kernel-server

  custom:
    - atuin-server
    - semaphore
    - gotty

  runtime:
    - docker

units:
  - name: caddy.service
    source: package
    enabled: true
    wants: network-online.target

  - name: pihole-FTL.service
    source: pihole_installer
    enabled: true
    wants: network-online.target

  - name: nfs-kernel-server.service
    source: package
    enabled: true
    requires: cluster-nas.mount

  - name: docker.service
    source: docker_installer
    enabled: true

  - name: atuin-server.service
    source: config/systemd/atuin-server.service
    enabled: true
    user: crtr

  - name: semaphore.service
    source: config/systemd/semaphore.service
    enabled: true
    user: crtr

  - name: gotty.service
    source: config/systemd/gotty.service
    enabled: true
    user: crtr

completion:
  all_enabled: true
  all_active: true
  no_failed: true

persistence:
  method: systemd_enable
  survives_reboot: true
  config_location: /etc/systemd/system/

growth:
  add_service: Copy unit file → systemctl daemon-reload → enable → start
  modify_service: Edit unit → systemctl daemon-reload → restart
  remove_service: stop → disable → remove unit file
